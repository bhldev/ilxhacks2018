<body>

    <pre id='search-results'>
      </pre>
      <script src="/socket.io/socket.io.js"></script>
      <script>
      
        /* SOCKET IO */
      
        var socket = io('http://10.10.121.7:8080');
        socket.emit('test', { data: 'data' });
        socket.on('test receive', function (data) {
          console.log('received: ' + JSON.stringify(data));
        });
      
        /* JIRA FUNCTIONS */
      
        var funcs = {};
      
        socket.on('jira-response', function (data) {
          console.log(data);
          var dataStr = JSON.stringify(data.data, undefined, 2);
          switch (data.type) {
            case 'DASHBOARD':
              var func = funcs['DASHBOARD'];
              console.log('dashboard:' + dataStr);
              if (typeof(func) === 'function') { func(dataStr); };
              break;
            case 'SEARCH':
              var func = funcs['SEARCH'];
              console.log('search:' + dataStr);
              if (typeof(func) === 'function') { func(dataStr); };
              break;
            default:
              console.log('data:' + dataStr);
          }
        });
      
        function sendJiraRequest(type, url, callback) {
          socket.emit('jira-request', { type: type, url: encodeURI(url) });
        }
      
        /* API CALLS */
      
        // THIS IS THE EXAMPLE
        // GET URLS FROM 
        function getDashboard(callback) {
          funcs['DASHBOARD'] = callback;
          sendJiraRequest('DASHBOARD', 'https://intelex.atlassian.net/rest/api/2/dashboard/10116');
        }
        // getDashboard();
      
        function search(key, value, callback) {
          funcs['SEARCH'] = callback;
          var url = 'https://intelex.atlassian.net/rest/api/2/search?jql="' + key + '"="' + value + '"';
          sendJiraRequest('SEARCH', url);
        }
        search('sprint', 'Cloud - Sprint 59', function (data) {   document.getElementById('search-results').innerHTML = data; });
      
      </script>

</body>

